{% extends 'parasitologyTool/base.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title_block %}Research Post Page{% endblock %}

{% block body_block %}
<style type="text/css">
	body {
		background: #E5E5E5;
	}

    .a-box {
        background: white; padding: 20px; border-radius: 5px;  width: 810px; margin-bottom: -10px;  float: left;
    }

    .a-s-box-author img {
        float: initial; width: 50px; height: 50px; border-radius: 50%;
    }

    .a-s-box-author {
        font-size: 15px;  padding-bottom: 10px; border-bottom: solid 0.5px silver;
    }

    .a-s-box-context {
        padding-left: 50px; border-bottom: solid 0.5px silver;
    }

    .a-s-box-context img {
         width: 180px; height: 180px; margin-right: 3px; margin-bottom: 3px; border-radius: 5px; object-fit: cover;
    }

    .a-s-box-bottom {
    	width: 380px;  text-align: center; float: left; padding-top: 7px;
    }

    .rside {
        width: 460px; margin-left: 820px; background: white; border-radius: 5px;
    }
    
    .rside-box {
        margin-left: 13px; margin-right: 13px; border-bottom: solid 0.5px silver; padding-bottom: 10px; font-size: 13px; 
    }

    .rside p {
    	font-size: 20px; padding: 7px; border-bottom: solid 0.5px silver;
    }
</style>
	<div class="a-box">
		<div class="a-s-box-author">
                    <img src="{% static 'images/researcher.jpeg' %}"
                                alt="picture of article" />  <stong>{{post.user.username}}</stong>
        </div>
        
        <div class="a-s-box-context">
            <div id="context">
		  <p>{{ post.content|linebreaks|urlize }}</p>
            </div>
		{% if post.images %}
			{% for image in post.images %}
				<img src="{{ MEDIA_URL }}{{ image.image }}">
			{% endfor %}
		{% endif %}
		<br>
		{% if post.files %}
			{% for file in post.files %}
				<a href="{{ MEDIA_URL }}{{ file.file }}">{{ file.file.name }}</a>
			{% endfor %}
		{% endif %}
	    </div>
	    <div class="a-s-box-bottom">
			    	Share
	    </div>
        <div class="a-s-box-bottom">
                	{% if user.is_authenticated %}
					<button id="like_btn"
					            data-categoryid="{{ post.id }}"
					            class="btn btn-primary btn-sm"
					            type="button">
					<span data-feather="thumbs-up"></span>
				    </button>
					{% endif %}
					<strong id="like_count">{{ post.likes }}</strong> likes 
	    </div>	
        <div>
		&nbsp;
		<h3>Comments ...</h3>
		<form id="comment_form" method="post" autocomplete="off" enctype="multipart/form-data">
            {% csrf_token %}
            {{ comment_form | crispy }}
            <button class="btn btn-outline-info" type="submit">add comment</button>
        </form>
        &nbsp;
        {% for comment in post.comments %}
        	<p>{{ comment }} - {{ comment.user.username }}</p>
        {% endfor %}
        </div>
		  
    </div>
    <div class="rside">
      <p><strong>Most Pupular Post</strong></p>

      <div class="rside-box">
      Example test
    </div>
     
</div>

<script type="text/javascript"> 
    function show()
    { 
        var box = document.getElementById("context"); 
        var text = box.innerHTML; 
        var newBox = document.createElement("div"); 
        var btn = document.createElement("a"); 
        newBox.innerHTML = text.substring(0,200); 
        btn.innerHTML = text.length > 200 ? "Show All" : ""; 
        btn.href = "###"; 
        btn.onclick = function(){ 
            if(btn.innerHTML == "Show All")
            { 
                btn.innerHTML = "Show Less"; 
                newBox.innerHTML = text; 
            }
            else
            { 
               btn.innerHTML = "Show All"; 
               newBox.innerHTML = text.substring(0,200); 
            } 
        } 
        box.innerHTML = ""; 
        box.appendChild(newBox); 
        box.appendChild(btn); 
    } 
    window.onload=function()
    {
        show(); 
    }
    </script>
{% endblock %}